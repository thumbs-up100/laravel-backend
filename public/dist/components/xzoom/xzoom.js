/**
 * @module       xZoom
 * @author       Azat Ahmedov & Elman Guseynov
 * @see          https://github.com/payalord/xZoom
 * @license      Apache License 2.0
 * @version      1.0.14
 * @requires     module:jquery
 */
function detect_old_ie(){if(!/MSIE (\d+\.\d+);/.test(navigator.userAgent))return!1;var t=new Number(RegExp.$1);return t>=9?!1:t>=8?!0:t>=7?!0:t>=6?!0:t>=5?!0:void 0}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,20)}}(),function(t){function e(e,i){function n(){var t=document.documentElement,e=(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0),i=(window.pageYOffset||t.scrollTop)-(t.clientTop||0);return{left:e,top:i}}function o(){var i=e.offset();if(g="auto"==ut.options.zoomWidth?rt:ut.options.zoomWidth,v="auto"==ut.options.zoomHeight?at:ut.options.zoomHeight,"#"==ut.options.position.substr(0,1)?dt=t(ut.options.position):dt.length=0,0!=dt.length)return!0;switch(lt){case"lens":case"inside":return!0;case"top":b=i.top,_=i.left,w=b-v,x=_;break;case"left":b=i.top,_=i.left,w=b,x=_-g;break;case"bottom":b=i.top,_=i.left,w=b+at,x=_;break;case"right":default:b=i.top,_=i.left,w=b,x=_+rt}return x+g>it||0>x?!1:!0}function s(){if("circle"==ut.options.lensShape&&"lens"==ut.options.position){L=j=Math.max(L,j);var t=(L+2*Math.max(X,R))/2;I.css({"-moz-border-radius":t,"-webkit-border-radius":t,"border-radius":t})}}function r(t,e,i,n){"lens"==ut.options.position?(A.css({top:-(e-b)*F+j/2,left:-(t-_)*Y+L/2}),ut.options.bg&&(I.css({"background-image":"url("+A.attr("src")+")","background-repeat":"no-repeat","background-position":-(t-_)*Y+L/2+"px "+(-(e-b)*F+j/2)+"px"}),i&&n&&I.css({"background-size":i+"px "+n+"px"}))):A.css({top:-H*F,left:-B*Y})}function a(t,e){-1>mt&&(mt=-1),mt>1&&(mt=1);var i,n,o;G>W?(i=W-(W-1)*mt,n=g*i,o=n/q):(i=G-(G-1)*mt,o=v*i,n=o*q),Q?(gt=t,vt=e,yt=n,bt=o):(Q||(_t=yt=n,wt=bt=o),Y=n/f,F=o/m,L=g/Y,j=v/F,s(),c(t,e),A.width(n),A.height(o),I.width(L),I.height(j),I.css({top:H-X,left:B-R}),O.css({top:-H,left:-B}),r(t,e,n,o))}function l(){var t=xt,e=kt,i=Ct,n=St,o=_t,a=wt;t+=(gt-t)/ut.options.smoothLensMove,e+=(vt-e)/ut.options.smoothLensMove,i+=(gt-i)/ut.options.smoothZoomMove,n+=(vt-n)/ut.options.smoothZoomMove,o+=(yt-o)/ut.options.smoothScale,a+=(bt-a)/ut.options.smoothScale,Y=o/f,F=a/m,L=g/Y,j=v/F,s(),c(t,e),A.width(o),A.height(a),I.width(L),I.height(j),I.css({top:H-X,left:B-R}),O.css({top:-H,left:-B}),c(i,n),r(t,e,o,a),xt=t,kt=e,Ct=i,St=n,_t=o,wt=a,Q&&requestAnimFrame(l)}function c(t,e){t-=_,e-=b,B=t-L/2,H=e-j/2,"lens"!=ut.options.position&&ut.options.lensCollision&&(0>B&&(B=0),f>=L&&B>f-L&&(B=f-L),L>f&&(B=f/2-L/2),0>H&&(H=0),m>=j&&H>m-j&&(H=m-j),j>m&&(H=m/2-j/2))}function u(){"undefined"!=typeof N&&N.remove(),"undefined"!=typeof P&&P.remove(),"undefined"!=typeof et&&et.remove()}function d(i,o){switch("fullscreen"==ut.options.position?(f=t(window).width(),m=t(window).height()):(f=e.width(),m=e.height()),$.css({top:m/2-$.height()/2,left:f/2-$.width()/2}),y=ut.options.rootOutput||"fullscreen"==ut.options.position?e.offset():e.position(),y.top=Math.round(y.top),y.left=Math.round(y.left),ut.options.position){case"fullscreen":b=n().top,_=n().left,w=0,x=0;break;case"inside":b=y.top,_=y.left,w=0,x=0;break;case"top":b=y.top,_=y.left,w=b-v,x=_;break;case"left":b=y.top,_=y.left,w=b,x=_-g;break;case"bottom":b=y.top,_=y.left,w=b+m,x=_;break;case"right":default:b=y.top,_=y.left,w=b,x=_+f}b-=N.outerHeight()/2,_-=N.outerWidth()/2,"#"==ut.options.position.substr(0,1)?dt=t(ut.options.position):dt.length=0,0==dt.length&&"inside"!=ut.options.position&&"fullscreen"!=ut.options.position?(ut.options.adaptive&&ot&&st||(ot=f,st=m),g="auto"==ut.options.zoomWidth?f:ut.options.zoomWidth,v="auto"==ut.options.zoomHeight?m:ut.options.zoomHeight,w+=ut.options.Yoffset,x+=ut.options.Xoffset,P.css({width:g+"px",height:v+"px",top:w,left:x}),"lens"!=ut.options.position&&p.append(P)):"inside"==ut.options.position||"fullscreen"==ut.options.position?(g=f,v=m,P.css({width:g+"px",height:v+"px"}),N.append(P)):(g=dt.width(),v=dt.height(),ut.options.rootOutput?(w=dt.offset().top,x=dt.offset().left,p.append(P)):(w=dt.position().top,x=dt.position().left,dt.parent().append(P)),w+=(dt.outerHeight()-v-P.outerHeight())/2,x+=(dt.outerWidth()-g-P.outerWidth())/2,P.css({width:g+"px",height:v+"px",top:w,left:x})),ut.options.title&&""!=Et&&("inside"==ut.options.position||"lens"==ut.options.position||"fullscreen"==ut.options.position?(k=w,C=x,N.append(et)):(k=w+(P.outerHeight()-v)/2,C=x+(P.outerWidth()-g)/2,p.append(et)),et.css({width:g+"px",height:v+"px",top:k,left:C})),N.css({width:f+"px",height:m+"px",top:b,left:_}),E.css({width:f+"px",height:m+"px"}),ut.options.tint&&"inside"!=ut.options.position&&"fullscreen"!=ut.options.position?E.css("background-color",ut.options.tint):Tt&&E.css({"background-image":"url("+e.attr("src")+")","background-color":"#fff"}),M=new Image;var s="";switch(Nt&&(s="?r="+(new Date).getTime()),M.src=e.attr("data-xoriginal")+s,A=t(M),A.css("position","absolute"),M=new Image,M.src=e.attr("src"),O=t(M),O.css("position","absolute"),O.width(f),ut.options.position){case"fullscreen":case"inside":P.append(A);break;case"lens":I.append(A),ut.options.bg&&A.css({display:"none"});break;default:P.append(A),I.append(O)}}function h(t){var e=t.attr("title"),i=t.attr("xtitle");return i?i:e?e:""}this.xzoom=!0;var p,f,m,g,v,y,b,_,w,x,k,C,S,T,N,E,P,$,z,D,M,A,I,O,L,j,B,H,R,X,Y,F,W,G,q,U,V,Q,K,Z,J,tt,et,it,nt,ot,st,rt,at,lt,ct,ut=this,dt={},ht=(new Array,new Array),pt=0,ft=0,mt=0,gt=0,vt=0,yt=0,bt=0,_t=0,wt=0,xt=0,kt=0,Ct=0,St=0,Tt=detect_old_ie(),Nt=/MSIE (\d+\.\d+);/.test(navigator.userAgent),Et="";this.adaptive=function(){(0==ot||0==st)&&(e.css("width",""),e.css("height",""),ot=e.width(),st=e.height()),u(),it=t(window).width(),nt=t(window).height(),rt=e.width(),at=e.height();var i=!1;(ot>it||st>nt)&&(i=!0),rt>ot&&(rt=ot),at>st&&(at=st),i?e.width("100%"):0!=ot&&e.width(ot),"fullscreen"!=lt&&(o()?ut.options.position=lt:ut.options.position=ut.options.mposition),ut.options.lensReverse||(ct=ut.options.adaptiveReverse&&ut.options.position==ut.options.mposition)},this.xscroll=function(t){if(S=t.pageX||t.originalEvent.pageX,T=t.pageY||t.originalEvent.pageY,t.preventDefault(),t.xscale)mt=t.xscale,a(S,T);else{var e=-t.originalEvent.detail||t.originalEvent.wheelDelta||t.xdelta,i=S,n=T;Tt&&(i=K,n=Z),e=e>0?-.05:.05,mt+=e,a(i,n)}},this.openzoom=function(e){switch(S=e.pageX,T=e.pageY,ut.options.adaptive&&ut.adaptive(),mt=ut.options.defaultScale,Q=!1,N=t("<div></div>"),""!=ut.options.sourceClass&&N.addClass(ut.options.sourceClass),N.css("position","absolute"),$=t("<div></div>"),""!=ut.options.loadingClass&&$.addClass(ut.options.loadingClass),$.css("position","absolute"),E=t('<div style="position: absolute; top: 0; left: 0;"></div>'),N.append($),P=t("<div></div>"),""!=ut.options.zoomClass&&"fullscreen"!=ut.options.position&&P.addClass(ut.options.zoomClass),P.css({position:"absolute",overflow:"hidden",opacity:1}),ut.options.title&&""!=Et&&(et=t("<div></div>"),tt=t("<div></div>"),et.css({position:"absolute",opacity:1}),ut.options.titleClass&&tt.addClass(ut.options.titleClass),tt.html("<span>"+Et+"</span>"),et.append(tt),ut.options.fadeIn&&et.css({opacity:0})),I=t("<div></div>"),""!=ut.options.lensClass&&I.addClass(ut.options.lensClass),I.css({position:"absolute",overflow:"hidden"}),ut.options.lens&&(lenstint=t("<div></div>"),lenstint.css({position:"absolute",background:ut.options.lens,opacity:ut.options.lensOpacity,width:"100%",height:"100%",top:0,left:0,"z-index":9999}),I.append(lenstint)),d(S,T),"inside"!=ut.options.position&&"fullscreen"!=ut.options.position?((ut.options.tint||Tt)&&N.append(E),ut.options.fadeIn&&(E.css({opacity:0}),I.css({opacity:0}),P.css({opacity:0})),p.append(N)):(ut.options.fadeIn&&P.css({opacity:0}),p.append(N)),ut.eventmove(N),ut.eventleave(N),ut.options.position){case"inside":w-=(P.outerHeight()-P.height())/2,x-=(P.outerWidth()-P.width())/2;break;case"top":w-=P.outerHeight()-P.height(),x-=(P.outerWidth()-P.width())/2;break;case"left":w-=(P.outerHeight()-P.height())/2,x-=P.outerWidth()-P.width();break;case"bottom":x-=(P.outerWidth()-P.width())/2;break;case"right":w-=(P.outerHeight()-P.height())/2}P.css({top:w,left:x}),A.xon("load",function(t){if($.remove(),!ut.options.openOnSmall&&(A.width()<g||A.height()<v))return ut.closezoom(),t.preventDefault(),!1;ut.options.scroll&&ut.eventscroll(N),"inside"!=ut.options.position&&"fullscreen"!=ut.options.position?(N.append(I),ut.options.fadeIn?(E.fadeTo(300,ut.options.tintOpacity),I.fadeTo(300,1),P.fadeTo(300,1)):(E.css({opacity:ut.options.tintOpacity}),I.css({opacity:1}),P.css({opacity:1}))):ut.options.fadeIn?P.fadeTo(300,1):P.css({opacity:1}),ut.options.title&&""!=Et&&(ut.options.fadeIn?et.fadeTo(300,1):et.css({opacity:1})),U=A.width(),V=A.height(),ut.options.adaptive&&(ot>f||st>m)&&(O.width(f),O.height(m),U=f/ot*U,V=m/st*V,A.width(U),A.height(V)),_t=yt=U,wt=bt=V,q=U/V,W=U/g,G=V/v;var e,i=["padding-","border-"];X=R=0;for(var n=0;n<i.length;n++)e=parseFloat(I.css(i[n]+"top-width")),X+=e!==e?0:e,e=parseFloat(I.css(i[n]+"bottom-width")),X+=e!==e?0:e,e=parseFloat(I.css(i[n]+"left-width")),R+=e!==e?0:e,e=parseFloat(I.css(i[n]+"right-width")),R+=e!==e?0:e;X/=2,R/=2,Ct=xt=gt=S,St=kt=vt=T,a(S,T),ut.options.smooth&&(Q=!0,requestAnimFrame(l)),ut.eventclick(N)})},this.movezoom=function(t){S=t.pageX,T=t.pageY,Tt&&(K=S,Z=T);var e=S-_,i=T-b;ct&&(t.pageX-=2*(e-f/2),t.pageY-=2*(i-m/2)),(0>e||e>f||0>i||i>m)&&N.trigger("mouseleave"),ut.options.smooth?(gt=t.pageX,vt=t.pageY):(s(),c(t.pageX,t.pageY),I.css({top:H-X,left:B-R}),O.css({top:-H,left:-B}),r(t.pageX,t.pageY,0,0))},this.eventdefault=function(){ut.eventopen=function(t){t.xon("mouseenter",ut.openzoom)},ut.eventleave=function(t){t.xon("mouseleave",ut.closezoom)},ut.eventmove=function(t){t.xon("mousemove",ut.movezoom)},ut.eventscroll=function(t){t.xon("mousewheel DOMMouseScroll",ut.xscroll)},ut.eventclick=function(t){t.xon("click",function(t){e.trigger("click")})}},this.eventunbind=function(){e.xoff("mouseenter"),ut.eventopen=function(t){},ut.eventleave=function(t){},ut.eventmove=function(t){},ut.eventscroll=function(t){},ut.eventclick=function(t){}},this.init=function(i){ut.options=t.extend({},t.fn.xzoom.defaults,i),p=ut.options.rootOutput?t("body"):e.parent(),lt=ut.options.position,ct=ut.options.lensReverse&&"inside"==ut.options.position,ut.options.smoothZoomMove<1&&(ut.options.smoothZoomMove=1),ut.options.smoothLensMove<1&&(ut.options.smoothLensMove=1),ut.options.smoothScale<1&&(ut.options.smoothScale=1),ut.options.adaptive&&t(window).xon("load",function(){ot=e.width(),st=e.height(),ut.adaptive(),t(window).resize(ut.adaptive)}),ut.eventdefault(),ut.eventopen(e)},this.destroy=function(){ut.eventunbind()},this.closezoom=function(){Q=!1,ut.options.fadeOut?(ut.options.title&&""!=Et&&et.fadeOut(299),"inside"!=ut.options.position||"fullscreen"!=ut.options.position?(P.fadeOut(299),N.fadeOut(300,function(){u()})):N.fadeOut(300,function(){u()})):u()},this.gallery=function(){var t,e=new Array,i=0;for(t=ft;t<ht.length;t++)e[i]=ht[t],i++;for(t=0;ft>t;t++)e[i]=ht[t],i++;return{index:ft,ogallery:ht,cgallery:e}},this.xappend=function(i){function n(n){u(),n.preventDefault(),ut.options.activeClass&&(J.removeClass(ut.options.activeClass),J=i,J.addClass(ut.options.activeClass)),ft=t(this).data("xindex"),ut.options.fadeTrans&&(D=new Image,D.src=e.attr("src"),z=t(D),z.css({position:"absolute",top:e.offset().top,left:e.offset().left,width:e.width(),height:e.height()}),t(document.body).append(z),z.fadeOut(200,function(){z.remove()}));var s=o.attr("href"),r=i.attr("xpreview")||i.attr("src");Et=h(i),i.attr("title")&&e.attr("title",i.attr("title")),e.attr("data-xoriginal",s),e.removeAttr("style"),e.attr("src",r),ut.options.adaptive&&(ot=e.width(),st=e.height())}var o=i.parent();ht[pt]=o.attr("href"),o.data("xindex",pt),0==pt&&ut.options.activeClass&&(J=i,J.addClass(ut.options.activeClass)),0==pt&&ut.options.title&&(Et=h(i)),pt++,ut.options.hover&&o.xon("mouseenter",o,n),o.xon("click",o,n)},this.init(i)}t.fn.xon=t.fn.on||t.fn.bind,t.fn.xoff=t.fn.off||t.fn.bind,t.fn.xzoom=function(i){var n,o;if(this.selector){var s=this.selector.split(",");for(var r in s)s[r]=t.trim(s[r]);this.each(function(r){if(1==s.length)if(0==r){if(n=t(this),"undefined"!=typeof n.data("xzoom"))return n.data("xzoom");n.x=new e(n,i)}else"undefined"!=typeof n.x&&(o=t(this),n.x.xappend(o));else if(t(this).is(s[0])&&0==r){if(n=t(this),"undefined"!=typeof n.data("xzoom"))return n.data("xzoom");n.x=new e(n,i)}else"undefined"==typeof n.x||t(this).is(s[0])||(o=t(this),n.x.xappend(o))})}else this.each(function(s){if(0==s){if(n=t(this),"undefined"!=typeof n.data("xzoom"))return n.data("xzoom");n.x=new e(n,i)}else"undefined"!=typeof n.x&&(o=t(this),n.x.xappend(o))});return"undefined"==typeof n?!1:(n.data("xzoom",n.x),t(n).trigger("xzoom_ready"),n.x)},t.fn.xzoom.defaults={position:"right",mposition:"inside",rootOutput:!0,Xoffset:0,Yoffset:0,fadeIn:!0,fadeTrans:!0,fadeOut:!1,smooth:!0,smoothZoomMove:3,smoothLensMove:1,smoothScale:6,defaultScale:0,scroll:!0,tint:!1,tintOpacity:.5,lens:!1,lensOpacity:.5,lensShape:"box",lensCollision:!0,lensReverse:!1,openOnSmall:!0,zoomWidth:"auto",zoomHeight:"auto",sourceClass:"xzoom-source",loadingClass:"xzoom-loading",lensClass:"xzoom-lens",zoomClass:"xzoom-preview",activeClass:"xactive",hover:!1,adaptive:!0,adaptiveReverse:!1,title:!1,titleClass:"xzoom-caption",bg:!1}}(jQuery);
