/**
 * @module       jQuery.dockmodal
 * @author       Tarafder Ashek E Elahi
 * @see          https://github.com/rguruprakash/angular-dockmodal
 * @license      MIT
 * @version      1.1
 * @requires     jquery.js
 */
!function(o){function t(o,t){var i=o.options.animationSpeed/1e3;return t.css({transition:i+"s right, "+i+"s left, "+i+"s top, "+i+"s bottom, "+i+"s height, "+i+"s width"}),!0}function i(o){return o.css({transition:"none"}),!0}var e={width:400,height:"65%",minimizedWidth:200,gutter:10,poppedOutDistance:"6%",title:function(){return""},dialogClass:"",buttons:[],animationSpeed:400,opacity:1,initialState:"modal",showClose:!0,showPopout:!0,showMinimize:!0,create:void 0,open:void 0,beforeClose:void 0,close:void 0,beforeMinimize:void 0,minimize:void 0,beforeRestore:void 0,restore:void 0,beforePopout:void 0,popout:void 0},n="dockmodal",s=(o(window).width(),{init:function(i){return this.each(function(){var a=o(this),d=a.data("dockmodal");if(a.options=o.extend({},e,i),function(){"function"==typeof a.options.title&&(a.options.title=a.options.title.call(a))}(),d)return o("body").append(a.closest("."+n).show()),s.refreshLayout(),void setTimeout(function(){s.restore.apply(a)},a.options.animationSpeed);a.data("dockmodal",a);var p=o("body"),r=o(window),l=o("<div/>").addClass(n).addClass(a.options.dialogClass);"modal"==a.options.initialState?l.addClass("popped-out"):"minimized"==a.options.initialState&&l.addClass("minimized"),l.height(0),t(a,l);var c=o("<div></div>").addClass(n+"-header");a.options.showClose&&o('<a href="#" class="header-action action-close" title="Close"><i class="icon-dockmodal-close"></i></a>').appendTo(c).click(function(o){return s.destroy.apply(a),!1}),a.options.showPopout&&o('<a href="#" class="header-action action-popout" title="Pop out"><i class="icon-dockmodal-popout"></i></a>').appendTo(c).click(function(o){return l.hasClass("popped-out")?s.restore.apply(a):s.popout.apply(a),!1}),a.options.showMinimize&&o('<a href="#" class="header-action action-minimize" title="Minimize"><i class="icon-dockmodal-minimize"></i></a>').appendTo(c).click(function(o){return l.hasClass("minimized")?l.hasClass("popped-out")?s.popout.apply(a):s.restore.apply(a):s.minimize.apply(a),!1}),a.options.showMinimize&&a.options.showPopout&&c.click(function(){return l.hasClass("minimized")?l.hasClass("popped-out")?s.popout.apply(a):s.restore.apply(a):s.minimize.apply(a),!1}),c.append('<div class="title-text">'+(a.options.title||a.attr("title"))+"</div>"),l.append(c);var u=o('<div class="modal-placeholder"></div>').insertAfter(a);a.placeholder=u;var h=o("<div></div>").addClass(n+"-body").append(a);if(l.append(h),a.options.buttons.length){var m=o("<div></div>").addClass(n+"-footer"),f=o("<div></div>").addClass(n+"-footer-buttonset");m.append(f),o.each(a.options.buttons,function(t,i){var e=o('<a href="#" class="btn"></a>');e.attr({id:i.id,"class":i.buttonClass}),e.html(i.html),e.click(function(o){return i.click(o,a),!1}),f.append(e)}),l.append(m)}else l.addClass("no-footer");var v=o("."+n+"-overlay");v.length||(v=o("<div/>").addClass(n+"-overlay")),o.isFunction(a.options.create)&&a.options.create(a),p.append(l),l.after(v),h.focus(),o.isFunction(a.options.open)&&setTimeout(function(){a.options.open(a)},a.options.animationSpeed),l.hasClass("minimized")?(l.find(".dockmodal-body, .dockmodal-footer").hide(),s.minimize.apply(a)):l.hasClass("popped-out")?s.popout.apply(a):s.restore.apply(a),p.data("windowWidth",r.width()),r.unbind("resize.dockmodal").bind("resize.dockmodal",function(){r.width()!=p.data("windowWidth")&&(p.data("windowWidth",r.width()),s.refreshLayout())})})},destroy:function(){return this.each(function(){var t=o(this).data("dockmodal");if(t&&(!o.isFunction(t.options.beforeClose)||t.options.beforeClose(t)!==!1))try{var i=t.closest("."+n);i.hasClass("popped-out")&&!i.hasClass("minimized")?i.css({left:"50%",right:"50%",top:"50%",bottom:"50%"}):i.css({width:"0",height:"0"}),setTimeout(function(){t.removeData("dockmodal"),t.placeholder.replaceWith(t),i.remove(),o("."+n+"-overlay").hide(),s.refreshLayout(),o.isFunction(t.options.close)&&t.options.close(t)},t.options.animationSpeed)}catch(e){alert(e.message)}})},close:function(){s.destroy.apply(this)},minimize:function(){return this.each(function(){var t=o(this).data("dockmodal");if(t&&(!o.isFunction(t.options.beforeMinimize)||t.options.beforeMinimize(t)!==!1)){var i=t.closest("."+n),e=i.find(".dockmodal-header").outerHeight();i.addClass("minimized").css({width:t.options.minimizedWidth+"px",height:e+"px",left:"auto",right:"auto",top:"auto",bottom:"0"}),setTimeout(function(){i.find(".dockmodal-body, .dockmodal-footer").hide(),o.isFunction(t.options.minimize)&&t.options.minimize(t)},t.options.animationSpeed),o("."+n+"-overlay").hide(),i.find(".action-minimize").attr("title","Restore"),s.refreshLayout()}})},restore:function(){return this.each(function(){var t=o(this).data("dockmodal");if(t&&(!o.isFunction(t.options.beforeRestore)||t.options.beforeRestore(t)!==!1)){var i=t.closest("."+n);i.removeClass("minimized popped-out"),i.find(".dockmodal-body, .dockmodal-footer").show(),i.css({width:t.options.width+"px",height:t.options.height,left:"auto",right:"auto",top:"auto",bottom:"0"}),o("."+n+"-overlay").hide(),i.find(".action-minimize").attr("title","Minimize"),i.find(".action-popout").attr("title","Pop-out"),setTimeout(function(){o.isFunction(t.options.restore)&&t.options.restore(t)},t.options.animationSpeed),s.refreshLayout()}})},popout:function(){return this.each(function(){var e=o(this).data("dockmodal");if(e&&(!o.isFunction(e.options.beforePopout)||e.options.beforePopout(e)!==!1)){var a=e.closest("."+n);a.find(".dockmodal-body, .dockmodal-footer").show(),i(a);var d=a.position(),p=o(window).width();a.css({width:"auto",height:"auto",left:d.left+"px",right:p-d.left-a.outerWidth(!0)+"px",top:d.top+"px",bottom:0}),t(e,a),setTimeout(function(){a.removeClass("minimized").addClass("popped-out").css({width:"auto",height:"auto",left:e.options.poppedOutDistance,right:e.options.poppedOutDistance,top:e.options.poppedOutDistance,bottom:e.options.poppedOutDistance}),o("."+n+"-overlay").show(),a.find(".action-popout").attr("title","Pop-in"),s.refreshLayout()},10),setTimeout(function(){o.isFunction(e.options.popout)&&e.options.popout(e)},e.options.animationSpeed)}})},refreshLayout:function(){var t=0,i=o(window).width();o.each(o("."+n).toArray().reverse(),function(e,s){var a=o(this),d=a.find("."+n+"-body > div").data("dockmodal");(!a.hasClass("popped-out")||a.hasClass("minimized"))&&(t+=d.options.gutter,a.css({right:t+"px"}),t+=a.hasClass("minimized")?d.options.minimizedWidth:d.options.width,t>i?a.hide():setTimeout(function(){a.show()},d.options.animationSpeed))})}});o.fn.dockmodal=function(t){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void o.error("Method "+t+" does not exist on jQuery.dockmodal"):s.init.apply(this,arguments)}}(jQuery);
